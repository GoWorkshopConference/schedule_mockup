<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>時間とブースのテーブル（修正版）</title>
  <style>
    table {
      border-collapse: collapse;
      width: 100%;
    }

    th,
    td {
      border: 1px solid black;
      padding: 5px;
      text-align: center;
    }

    th {
      background-color: #f2f2f2;
    }
  </style>
</head>

<body>
  <table id="timeBoothTable"></table>

  <script>
    const times = [];
    for (let hour = 10; hour <= 19; hour++) {
      for (let minute = 0; minute < 60; minute += 15) {
        if (hour === 19 && minute > 0) break; // 19:00で終了
        times.push(`${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`);
      }
    }
    const booths = Array.from({ length: 15 }, (_, i) => i + 1);

    // スケジュールデータ
    const data = [
      // 共通イベント
      { time: '10:00', booth: 1, value: 'オープニング', horizontal: true },
      { time: '13:00', booth: 1, value: 'お昼休憩', horizontal: true },
      { time: '13:15', booth: 1, value: 'お昼休憩', horizontal: true },
      { time: '13:30', booth: 1, value: 'お昼休憩', horizontal: true },
      { time: '13:45', booth: 1, value: 'お昼休憩', horizontal: true },
      { time: '17:15', booth: 1, value: 'エンディング', horizontal: true },
      { time: '17:30', booth: 1, value: '参加者退場', horizontal: true },
      { time: '17:45', booth: 1, value: '参加者退場', horizontal: true },
      { time: '18:00', booth: 1, value: '会場片付け', horizontal: true },
      { time: '18:15', booth: 1, value: '会場片付け', horizontal: true },
      { time: '18:30', booth: 1, value: '会場片付け', horizontal: true },
      { time: '18:45', booth: 1, value: '完全撤収', horizontal: true },
      { time: '19:00', booth: 1, value: '撤収済み', horizontal: true },
      // 大ブース1
      { time: "10:15", booth: 1, value: '大ブース1 WorkShopA' },
      { time: "10:30", booth: 1, value: '大ブース1 WorkShopA' },
      { time: "10:45", booth: 1, value: '大ブース1 WorkShopA' },
      { time: "11:00", booth: 1, value: '大ブース1 WorkShopA' },
      { time: "11:45", booth: 1, value: '大ブース1 WorkShopB' },
      { time: "12:00", booth: 1, value: '大ブース1 WorkShopB' },
      { time: "12:15", booth: 1, value: '大ブース1 WorkShopB' },
      { time: "12:30", booth: 1, value: '大ブース1 WorkShopB' },
      { time: "12:45", booth: 1, value: '大ブース1 WorkShopB' },
      { time: "14:00", booth: 1, value: '大ブース1 WorkShopC' },
      { time: "14:15", booth: 1, value: '大ブース1 WorkShopC' },
      { time: "14:30", booth: 1, value: '大ブース1 WorkShopC' },
      { time: "14:45", booth: 1, value: '大ブース1 WorkShopC' },
      { time: "15:00", booth: 1, value: '大ブース1 WorkShopC' },
      { time: "15:45", booth: 1, value: '大ブース1 WorkShopD' },
      { time: "16:00", booth: 1, value: '大ブース1 WorkShopD' },
      { time: "16:15", booth: 1, value: '大ブース1 WorkShopD' },
      { time: "16:30", booth: 1, value: '大ブース1 WorkShopD' },
      { time: "16:45", booth: 1, value: '大ブース1 WorkShopD' },
      // 大ブース2
      { time: "10:15", booth: 2, value: '大ブース2 WorkShopA' },
      { time: "10:30", booth: 2, value: '大ブース2 WorkShopA' },
      { time: "10:45", booth: 2, value: '大ブース2 WorkShopA' },
      { time: "11:00", booth: 2, value: '大ブース2 WorkShopA' },
      { time: "11:45", booth: 2, value: '大ブース2 WorkShopB' },
      { time: "12:00", booth: 2, value: '大ブース2 WorkShopB' },
      { time: "12:15", booth: 2, value: '大ブース2 WorkShopB' },
      { time: "12:30", booth: 2, value: '大ブース2 WorkShopB' },
      { time: "12:45", booth: 2, value: '大ブース2 WorkShopB' },
      { time: "14:00", booth: 2, value: '大ブース2 WorkShopC' },
      { time: "14:15", booth: 2, value: '大ブース2 WorkShopC' },
      { time: "14:30", booth: 2, value: '大ブース2 WorkShopC' },
      { time: "14:45", booth: 2, value: '大ブース2 WorkShopC' },
      { time: "15:00", booth: 2, value: '大ブース2 WorkShopC' },
      { time: "15:45", booth: 2, value: '大ブース2 WorkShopD' },
      { time: "16:00", booth: 2, value: '大ブース2 WorkShopD' },
      { time: "16:15", booth: 2, value: '大ブース2 WorkShopD' },
      { time: "16:30", booth: 2, value: '大ブース2 WorkShopD' },
      { time: "16:45", booth: 2, value: '大ブース2 WorkShopD' },
      // 大ブース3
      { time: "10:15", booth: 3, value: '大ブース3 WorkShopA' },
      { time: "10:30", booth: 3, value: '大ブース3 WorkShopA' },
      { time: "10:45", booth: 3, value: '大ブース3 WorkShopA' },
      { time: "11:00", booth: 3, value: '大ブース3 WorkShopA' },
      { time: "11:45", booth: 3, value: '大ブース3 WorkShopB' },
      { time: "12:00", booth: 3, value: '大ブース3 WorkShopB' },
      { time: "12:15", booth: 3, value: '大ブース3 WorkShopB' },
      { time: "12:30", booth: 3, value: '大ブース3 WorkShopB' },
      { time: "12:45", booth: 3, value: '大ブース3 WorkShopB' },
      { time: "14:00", booth: 3, value: '大ブース3 WorkShopC' },
      { time: "14:15", booth: 3, value: '大ブース3 WorkShopC' },
      { time: "14:30", booth: 3, value: '大ブース3 WorkShopC' },
      { time: "14:45", booth: 3, value: '大ブース3 WorkShopC' },
      { time: "15:00", booth: 3, value: '大ブース3 WorkShopC' },
      { time: "15:45", booth: 3, value: '大ブース3 WorkShopD' },
      { time: "16:00", booth: 3, value: '大ブース3 WorkShopD' },
      { time: "16:15", booth: 3, value: '大ブース3 WorkShopD' },
      { time: "16:30", booth: 3, value: '大ブース3 WorkShopD' },
      { time: "16:45", booth: 3, value: '大ブース3 WorkShopD' },
      // ブース4
      { time: "10:15", booth: 4, value: 'ブース4 WorkShopA' },
      { time: "10:30", booth: 4, value: 'ブース4 WorkShopA' },
      { time: "10:45", booth: 4, value: 'ブース4 WorkShopA' },
      { time: "11:15", booth: 4, value: 'ブース4 WorkShopB' },
      { time: "11:30", booth: 4, value: 'ブース4 WorkShopB' },
      { time: "11:45", booth: 4, value: 'ブース4 WorkShopB' },
      { time: "12:15", booth: 4, value: 'ブース4 WorkShopC' },
      { time: "12:30", booth: 4, value: 'ブース4 WorkShopC' },
      { time: "12:45", booth: 4, value: 'ブース4 WorkShopC' },
      { time: "14:15", booth: 4, value: 'ブース4 WorkShopD' },
      { time: "14:30", booth: 4, value: 'ブース4 WorkShopD' },
      { time: "14:45", booth: 4, value: 'ブース4 WorkShopD' },
      { time: "15:15", booth: 4, value: 'ブース4 WorkShopE' },
      { time: "15:30", booth: 4, value: 'ブース4 WorkShopE' },
      { time: "15:45", booth: 4, value: 'ブース4 WorkShopE' },
      { time: "16:15", booth: 4, value: 'ブース4 WorkShopF' },
      { time: "16:30", booth: 4, value: 'ブース4 WorkShopF' },
      { time: "16:45", booth: 4, value: 'ブース4 WorkShopF' },
      // ブース5
      { time: "10:15", booth: 5, value: 'ブース5 WorkShopA' },
      { time: "10:30", booth: 5, value: 'ブース5 WorkShopA' },
      { time: "10:45", booth: 5, value: 'ブース5 WorkShopA' },
      { time: "11:15", booth: 5, value: 'ブース5 WorkShopB' },
      { time: "11:30", booth: 5, value: 'ブース5 WorkShopB' },
      { time: "11:45", booth: 5, value: 'ブース5 WorkShopB' },
      { time: "12:15", booth: 5, value: 'ブース5 WorkShopC' },
      { time: "12:30", booth: 5, value: 'ブース5 WorkShopC' },
      { time: "12:45", booth: 5, value: 'ブース5 WorkShopC' },
      { time: "14:15", booth: 5, value: 'ブース5 WorkShopD' },
      { time: "14:30", booth: 5, value: 'ブース5 WorkShopD' },
      { time: "14:45", booth: 5, value: 'ブース5 WorkShopD' },
      { time: "15:15", booth: 5, value: 'ブース5 WorkShopE' },
      { time: "15:30", booth: 5, value: 'ブース5 WorkShopE' },
      { time: "15:45", booth: 5, value: 'ブース5 WorkShopE' },
      { time: "16:15", booth: 5, value: 'ブース5 WorkShopF' },
      { time: "16:30", booth: 5, value: 'ブース5 WorkShopF' },
      { time: "16:45", booth: 5, value: 'ブース5 WorkShopF' },
      // ブース6
      { time: "10:15", booth: 6, value: 'ブース6 WorkShopA' },
      { time: "10:30", booth: 6, value: 'ブース6 WorkShopA' },
      { time: "10:45", booth: 6, value: 'ブース6 WorkShopA' },
      { time: "11:15", booth: 6, value: 'ブース6 WorkShopB' },
      { time: "11:30", booth: 6, value: 'ブース6 WorkShopB' },
      { time: "11:45", booth: 6, value: 'ブース6 WorkShopB' },
      { time: "12:15", booth: 6, value: 'ブース6 WorkShopC' },
      { time: "12:30", booth: 6, value: 'ブース6 WorkShopC' },
      { time: "12:45", booth: 6, value: 'ブース6 WorkShopC' },
      { time: "14:15", booth: 6, value: 'ブース6 WorkShopD' },
      { time: "14:30", booth: 6, value: 'ブース6 WorkShopD' },
      { time: "14:45", booth: 6, value: 'ブース6 WorkShopD' },
      { time: "15:15", booth: 6, value: 'ブース6 WorkShopE' },
      { time: "15:30", booth: 6, value: 'ブース6 WorkShopE' },
      { time: "15:45", booth: 6, value: 'ブース6 WorkShopE' },
      { time: "16:15", booth: 6, value: 'ブース6 WorkShopF' },
      { time: "16:30", booth: 6, value: 'ブース6 WorkShopF' },
      { time: "16:45", booth: 6, value: 'ブース6 WorkShopF' },
      // ブース7
      { time: "10:15", booth: 7, value: 'ブース7 WorkShopA' },
      { time: "10:30", booth: 7, value: 'ブース7 WorkShopA' },
      { time: "10:45", booth: 7, value: 'ブース7 WorkShopA' },
      { time: "11:15", booth: 7, value: 'ブース7 WorkShopB' },
      { time: "11:30", booth: 7, value: 'ブース7 WorkShopB' },
      { time: "11:45", booth: 7, value: 'ブース7 WorkShopB' },
      { time: "12:15", booth: 7, value: 'ブース7 WorkShopC' },
      { time: "12:30", booth: 7, value: 'ブース7 WorkShopC' },
      { time: "12:45", booth: 7, value: 'ブース7 WorkShopC' },
      { time: "14:15", booth: 7, value: 'ブース7 WorkShopD' },
      { time: "14:30", booth: 7, value: 'ブース7 WorkShopD' },
      { time: "14:45", booth: 7, value: 'ブース7 WorkShopD' },
      { time: "15:15", booth: 7, value: 'ブース7 WorkShopE' },
      { time: "15:30", booth: 7, value: 'ブース7 WorkShopE' },
      { time: "15:45", booth: 7, value: 'ブース7 WorkShopE' },
      { time: "16:15", booth: 7, value: 'ブース7 WorkShopF' },
      { time: "16:30", booth: 7, value: 'ブース7 WorkShopF' },
      { time: "16:45", booth: 7, value: 'ブース7 WorkShopF' },
      // ブース8
      { time: "10:15", booth: 8, value: 'ブース8 WorkShopA' },
      { time: "10:30", booth: 8, value: 'ブース8 WorkShopA' },
      { time: "10:45", booth: 8, value: 'ブース8 WorkShopA' },
      { time: "11:15", booth: 8, value: 'ブース8 WorkShopB' },
      { time: "11:30", booth: 8, value: 'ブース8 WorkShopB' },
      { time: "11:45", booth: 8, value: 'ブース8 WorkShopB' },
      { time: "12:15", booth: 8, value: 'ブース8 WorkShopC' },
      { time: "12:30", booth: 8, value: 'ブース8 WorkShopC' },
      { time: "12:45", booth: 8, value: 'ブース8 WorkShopC' },
      { time: "14:15", booth: 8, value: 'ブース8 WorkShopD' },
      { time: "14:30", booth: 8, value: 'ブース8 WorkShopD' },
      { time: "14:45", booth: 8, value: 'ブース8 WorkShopD' },
      { time: "15:15", booth: 8, value: 'ブース8 WorkShopE' },
      { time: "15:30", booth: 8, value: 'ブース8 WorkShopE' },
      { time: "15:45", booth: 8, value: 'ブース8 WorkShopE' },
      { time: "16:15", booth: 8, value: 'ブース8 WorkShopF' },
      { time: "16:30", booth: 8, value: 'ブース8 WorkShopF' },
      { time: "16:45", booth: 8, value: 'ブース8 WorkShopF' },
      // ブース9
      { time: "10:15", booth: 9, value: 'ブース9 WorkShopA' },
      { time: "10:30", booth: 9, value: 'ブース9 WorkShopA' },
      { time: "10:45", booth: 9, value: 'ブース9 WorkShopA' },
      { time: "11:15", booth: 9, value: 'ブース9 WorkShopB' },
      { time: "11:30", booth: 9, value: 'ブース9 WorkShopB' },
      { time: "11:45", booth: 9, value: 'ブース9 WorkShopB' },
      { time: "12:15", booth: 9, value: 'ブース9 WorkShopC' },
      { time: "12:30", booth: 9, value: 'ブース9 WorkShopC' },
      { time: "12:45", booth: 9, value: 'ブース9 WorkShopC' },
      { time: "14:15", booth: 9, value: 'ブース9 WorkShopD' },
      { time: "14:30", booth: 9, value: 'ブース9 WorkShopD' },
      { time: "14:45", booth: 9, value: 'ブース9 WorkShopD' },
      { time: "15:15", booth: 9, value: 'ブース9 WorkShopE' },
      { time: "15:30", booth: 9, value: 'ブース9 WorkShopE' },
      { time: "15:45", booth: 9, value: 'ブース9 WorkShopE' },
      { time: "16:15", booth: 9, value: 'ブース9 WorkShopF' },
      { time: "16:30", booth: 9, value: 'ブース9 WorkShopF' },
      { time: "16:45", booth: 9, value: 'ブース9 WorkShopF' },
      // ブース10
      { time: "10:15", booth: 10, value: 'ブース10 WorkShopA' },
      { time: "10:30", booth: 10, value: 'ブース10 WorkShopA' },
      { time: "10:45", booth: 10, value: 'ブース10 WorkShopA' },
      { time: "11:15", booth: 10, value: 'ブース10 WorkShopB' },
      { time: "11:30", booth: 10, value: 'ブース10 WorkShopB' },
      { time: "11:45", booth: 10, value: 'ブース10 WorkShopB' },
      { time: "12:15", booth: 10, value: 'ブース10 WorkShopC' },
      { time: "12:30", booth: 10, value: 'ブース10 WorkShopC' },
      { time: "12:45", booth: 10, value: 'ブース10 WorkShopC' },
      { time: "14:15", booth: 10, value: 'ブース10 WorkShopD' },
      { time: "14:30", booth: 10, value: 'ブース10 WorkShopD' },
      { time: "14:45", booth: 10, value: 'ブース10 WorkShopD' },
      { time: "15:15", booth: 10, value: 'ブース10 WorkShopE' },
      { time: "15:30", booth: 10, value: 'ブース10 WorkShopE' },
      { time: "15:45", booth: 10, value: 'ブース10 WorkShopE' },
      { time: "16:15", booth: 10, value: 'ブース10 WorkShopF' },
      { time: "16:30", booth: 10, value: 'ブース10 WorkShopF' },
      { time: "16:45", booth: 10, value: 'ブース10 WorkShopF' },
      // ブース11
      { time: "10:15", booth: 11, value: 'ブース11 WorkShopA' },
      { time: "10:30", booth: 11, value: 'ブース11 WorkShopA' },
      { time: "10:45", booth: 11, value: 'ブース11 WorkShopA' },
      { time: "11:15", booth: 11, value: 'ブース11 WorkShopB' },
      { time: "11:30", booth: 11, value: 'ブース11 WorkShopB' },
      { time: "11:45", booth: 11, value: 'ブース11 WorkShopB' },
      { time: "12:15", booth: 11, value: 'ブース11 WorkShopC' },
      { time: "12:30", booth: 11, value: 'ブース11 WorkShopC' },
      { time: "12:45", booth: 11, value: 'ブース11 WorkShopC' },
      { time: "14:15", booth: 11, value: 'ブース11 WorkShopD' },
      { time: "14:30", booth: 11, value: 'ブース11 WorkShopD' },
      { time: "14:45", booth: 11, value: 'ブース11 WorkShopD' },
      { time: "15:15", booth: 11, value: 'ブース11 WorkShopE' },
      { time: "15:30", booth: 11, value: 'ブース11 WorkShopE' },
      { time: "15:45", booth: 11, value: 'ブース11 WorkShopE' },
      { time: "16:15", booth: 11, value: 'ブース11 WorkShopF' },
      { time: "16:30", booth: 11, value: 'ブース11 WorkShopF' },
      { time: "16:45", booth: 11, value: 'ブース11 WorkShopF' },
      // ブース12
      { time: "10:15", booth: 12, value: 'ブース12 WorkShopA' },
      { time: "10:30", booth: 12, value: 'ブース12 WorkShopA' },
      { time: "10:45", booth: 12, value: 'ブース12 WorkShopA' },
      { time: "11:15", booth: 12, value: 'ブース12 WorkShopB' },
      { time: "11:30", booth: 12, value: 'ブース12 WorkShopB' },
      { time: "11:45", booth: 12, value: 'ブース12 WorkShopB' },
      { time: "12:15", booth: 12, value: 'ブース12 WorkShopC' },
      { time: "12:30", booth: 12, value: 'ブース12 WorkShopC' },
      { time: "12:45", booth: 12, value: 'ブース12 WorkShopC' },
      { time: "14:15", booth: 12, value: 'ブース12 WorkShopD' },
      { time: "14:30", booth: 12, value: 'ブース12 WorkShopD' },
      { time: "14:45", booth: 12, value: 'ブース12 WorkShopD' },
      { time: "15:15", booth: 12, value: 'ブース12 WorkShopE' },
      { time: "15:30", booth: 12, value: 'ブース12 WorkShopE' },
      { time: "15:45", booth: 12, value: 'ブース12 WorkShopE' },
      { time: "16:15", booth: 12, value: 'ブース12 WorkShopF' },
      { time: "16:30", booth: 12, value: 'ブース12 WorkShopF' },
      { time: "16:45", booth: 12, value: 'ブース12 WorkShopF' },
      // ブース13
      { time: "10:15", booth: 13, value: 'ブース13 WorkShopA' },
      { time: "10:30", booth: 13, value: 'ブース13 WorkShopA' },
      { time: "10:45", booth: 13, value: 'ブース13 WorkShopA' },
      { time: "11:15", booth: 13, value: 'ブース13 WorkShopB' },
      { time: "11:30", booth: 13, value: 'ブース13 WorkShopB' },
      { time: "11:45", booth: 13, value: 'ブース13 WorkShopB' },
      { time: "12:15", booth: 13, value: 'ブース13 WorkShopC' },
      { time: "12:30", booth: 13, value: 'ブース13 WorkShopC' },
      { time: "12:45", booth: 13, value: 'ブース13 WorkShopC' },
      { time: "14:15", booth: 13, value: 'ブース13 WorkShopD' },
      { time: "14:30", booth: 13, value: 'ブース13 WorkShopD' },
      { time: "14:45", booth: 13, value: 'ブース13 WorkShopD' },
      { time: "15:15", booth: 13, value: 'ブース13 WorkShopE' },
      { time: "15:30", booth: 13, value: 'ブース13 WorkShopE' },
      { time: "15:45", booth: 13, value: 'ブース13 WorkShopE' },
      { time: "16:15", booth: 13, value: 'ブース13 WorkShopF' },
      { time: "16:30", booth: 13, value: 'ブース13 WorkShopF' },
      { time: "16:45", booth: 13, value: 'ブース13 WorkShopF' },
      // ブース14
      { time: "10:15", booth: 14, value: 'ブース14 WorkShopA' },
      { time: "10:30", booth: 14, value: 'ブース14 WorkShopA' },
      { time: "10:45", booth: 14, value: 'ブース14 WorkShopA' },
      { time: "11:15", booth: 14, value: 'ブース14 WorkShopB' },
      { time: "11:30", booth: 14, value: 'ブース14 WorkShopB' },
      { time: "11:45", booth: 14, value: 'ブース14 WorkShopB' },
      { time: "12:15", booth: 14, value: 'ブース14 WorkShopC' },
      { time: "12:30", booth: 14, value: 'ブース14 WorkShopC' },
      { time: "12:45", booth: 14, value: 'ブース14 WorkShopC' },
      { time: "14:15", booth: 14, value: 'ブース14 WorkShopD' },
      { time: "14:30", booth: 14, value: 'ブース14 WorkShopD' },
      { time: "14:45", booth: 14, value: 'ブース14 WorkShopD' },
      { time: "15:15", booth: 14, value: 'ブース14 WorkShopE' },
      { time: "15:30", booth: 14, value: 'ブース14 WorkShopE' },
      { time: "15:45", booth: 14, value: 'ブース14 WorkShopE' },
      { time: "16:15", booth: 14, value: 'ブース14 WorkShopF' },
      { time: "16:30", booth: 14, value: 'ブース14 WorkShopF' },
      { time: "16:45", booth: 14, value: 'ブース14 WorkShopF' },
      // ブース15
      { time: "10:15", booth: 15, value: 'ブース15 WorkShopA' },
      { time: "10:30", booth: 15, value: 'ブース15 WorkShopA' },
      { time: "10:45", booth: 15, value: 'ブース15 WorkShopA' },
      { time: "11:15", booth: 15, value: 'ブース15 WorkShopB' },
      { time: "11:30", booth: 15, value: 'ブース15 WorkShopB' },
      { time: "11:45", booth: 15, value: 'ブース15 WorkShopB' },
      { time: "12:15", booth: 15, value: 'ブース15 WorkShopC' },
      { time: "12:30", booth: 15, value: 'ブース15 WorkShopC' },
      { time: "12:45", booth: 15, value: 'ブース15 WorkShopC' },
      { time: "14:15", booth: 15, value: 'ブース15 WorkShopD' },
      { time: "14:30", booth: 15, value: 'ブース15 WorkShopD' },
      { time: "14:45", booth: 15, value: 'ブース15 WorkShopD' },
      { time: "15:15", booth: 15, value: 'ブース15 WorkShopE' },
      { time: "15:30", booth: 15, value: 'ブース15 WorkShopE' },
      { time: "15:45", booth: 15, value: 'ブース15 WorkShopE' },
      { time: "16:15", booth: 15, value: 'ブース15 WorkShopF' },
      { time: "16:30", booth: 15, value: 'ブース15 WorkShopF' },
      { time: "16:45", booth: 15, value: 'ブース15 WorkShopF' }
    ];

    function createTable() {
      const table = document.getElementById('timeBoothTable');

      // ヘッダー行を作成
      const headerRow = table.insertRow();
      headerRow.insertCell().textContent = '時間\\ブース';
      booths.forEach(booth => {
        headerRow.insertCell().textContent = booth;
      });

      // データ行を作成し、データを埋める
      const cellData = Array.from({ length: times.length }, () => Array(booths.length).fill(null));
      const usedCells = new Set();

      data.forEach(item => {
        const rowIndex = times.indexOf(item.time);
        const colIndex = item.booth - 1;
        const cellKey = `${rowIndex},${colIndex}`;

        if (!usedCells.has(cellKey)) {
          cellData[rowIndex][colIndex] = { text: item.value, rowspan: 1, colspan: 1 };
          usedCells.add(cellKey);

          // 縦方向の結合をチェック
          let rowspan = 1;
          for (let i = rowIndex + 1; i < times.length; i++) {
            if (data.some(d => d.time === times[i] && d.booth === item.booth && d.value === item.value)) {
              const existingCellKey = `${i},${colIndex}`;
              if (usedCells.has(existingCellKey)) {
                usedCells.delete(existingCellKey);
              }
              rowspan++;
              usedCells.add(existingCellKey);
            } else {
              break;
            }
          }
          if (rowspan > 1) {
            cellData[rowIndex][colIndex].rowspan = rowspan;
            for (let i = 1; i < rowspan; i++) {
              cellData[rowIndex + i][colIndex] = undefined;
            }
          }

          // 横方向の結合をチェック
          if (item.horizontal) {
            let colspan = booths.length;
            for (let j = 0; j < booths.length; j++) {
              const existingCellKey = `${rowIndex},${j}`;
              if (usedCells.has(existingCellKey)) {
                usedCells.delete(existingCellKey);
              }
              if (j !== colIndex) {
                cellData[rowIndex][j] = undefined;
              }
              usedCells.add(existingCellKey);
            }

            // 縦方向の結合も考慮
            let additionalRowSpan = 1;
            for (let i = rowIndex + 1; i < times.length; i++) {
              if (data.some(d => d.time === times[i] && d.value === item.value && d.horizontal)) {
                additionalRowSpan++;
                for (let j = 0; j < booths.length; j++) {
                  const existingCellKey = `${i},${j}`;
                  if (usedCells.has(existingCellKey)) {
                    usedCells.delete(existingCellKey);
                  }
                  usedCells.add(existingCellKey);
                  if (j !== colIndex) {
                    cellData[i][j] = undefined;
                  }
                }
              } else {
                break;
              }
            }

            cellData[rowIndex][colIndex].colspan = colspan;
            cellData[rowIndex][colIndex].rowspan = additionalRowSpan;
          }
        }
      });

      // テーブルにデータを埋め込む
      for (let i = 0; i < times.length; i++) {
        const row = table.insertRow();
        const timeCell = row.insertCell();
        timeCell.textContent = times[i];

        for (let j = 0; j < booths.length; j++) {
          const cellDataItem = cellData[i][j];
          if (cellDataItem !== undefined) {
            const cell = row.insertCell();
            if (cellDataItem) {
              cell.textContent = cellDataItem.text;
              if (cellDataItem.rowspan > 1) {
                cell.rowSpan = cellDataItem.rowspan;
              }
              if (cellDataItem.colspan > 1) {
                cell.colSpan = cellDataItem.colspan;
              }
            }
          }
        }
      }
    }

    createTable();
  </script>
</body>

</html>
